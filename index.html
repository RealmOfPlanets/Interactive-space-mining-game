<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asteroid Mining Game</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #000;
            color: #00ff00;
            font-family: 'Courier New', monospace;
            background-image: 
                radial-gradient(white, rgba(255,255,255,.2) 2px, transparent 40px),
                radial-gradient(white, rgba(255,255,255,.15) 1px, transparent 30px),
                radial-gradient(white, rgba(255,255,255,.1) 2px, transparent 40px);
            background-size: 550px 550px, 350px 350px, 250px 250px;
            background-position: 0 0, 40px 60px, 130px 270px;
        }
        .control-panel {
            max-width: 1000px;
            margin: 0 auto;
            background: rgba(0, 20, 0, 0.9);
            border: 2px solid #00ff00;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 0 20px #00ff00;
        }
        .title {
            text-align: center;
            font-size: 24px;
            margin-bottom: 20px;
            text-shadow: 0 0 10px #00ff00;
        }
        .pilot-info {
            text-align: center;
            margin-bottom: 20px;
            font-size: 14px;
        }
        .status-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        .status-item {
            background: rgba(0, 40, 0, 0.7);
            border: 1px solid #00aa00;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
        }
        .status-label {
            font-size: 12px;
            opacity: 0.8;
            margin-bottom: 5px;
        }
        .status-value {
            font-size: 18px;
            font-weight: bold;
        }
        .main-display {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        .scanner, .cargo {
            background: rgba(0, 40, 0, 0.7);
            border: 1px solid #00aa00;
            padding: 15px;
            border-radius: 5px;
            height: 300px;
            overflow-y: auto;
        }
        .asteroid-item, .cargo-item {
            margin: 5px 0;
            padding: 10px;
            background: rgba(0, 60, 0, 0.5);
            border-radius: 3px;
            cursor: pointer;
            border: 1px solid transparent;
            transition: all 0.2s;
        }
        .asteroid-item:hover {
            border-color: #00ff00;
            background: rgba(0, 80, 0, 0.7);
        }
        .asteroid-item.selected {
            border-color: #00ff00;
            background: rgba(0, 100, 0, 0.8);
        }
        .controls {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
        }
        .setup-form {
            background: rgba(0, 40, 0, 0.9);
            border: 2px solid #00ff00;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            max-width: 400px;
            margin: 50px auto;
        }
        .setup-form input {
            background: rgba(0, 60, 0, 0.8);
            border: 1px solid #00aa00;
            color: #00ff00;
            padding: 10px;
            margin: 10px;
            border-radius: 5px;
            font-family: inherit;
            font-size: 16px;
            width: 200px;
        }
        button {
            background: rgba(0, 60, 0, 0.8);
            color: #00ff00;
            border: 1px solid #00aa00;
            padding: 15px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-family: inherit;
            font-size: 14px;
            transition: all 0.2s;
        }
        button:hover:not(:disabled) {
            background: rgba(0, 80, 0, 1);
            border-color: #00ff00;
            box-shadow: 0 0 10px rgba(0, 255, 0, 0.3);
        }
        button:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        .hidden { display: none; }
        .log {
            background: rgba(0, 40, 0, 0.7);
            border: 1px solid #00aa00;
            padding: 10px;
            border-radius: 5px;
            height: 100px;
            overflow-y: auto;
            margin-bottom: 20px;
            font-size: 12px;
        }
        .log-entry {
            margin: 2px 0;
            opacity: 0.9;
        }
    </style>
</head>
<body>
    <div id="setup-screen" class="setup-form">
        <h2>MINING VESSEL INITIALIZATION</h2>
        <p>Enter your pilot name and ship designation:</p>
        <div>
            <input type="text" id="pilot-name" placeholder="Pilot Name" maxlength="20">
        </div>
        <div>
            <input type="text" id="ship-name" placeholder="Ship Name" maxlength="25">
        </div>
        <br>
        <button onclick="startGame()">INITIALIZE SYSTEMS</button>
    </div>

    <div id="game-screen" class="control-panel hidden">
        <div class="title">ASTEROID MINING VESSEL - CONTROL INTERFACE</div>
        <div class="pilot-info">
            Pilot: <span id="display-pilot">Unknown</span> | Ship: <span id="display-ship">Unnamed</span>
        </div>
        
        <div class="status-grid">
            <div class="status-item">
                <div class="status-label">CREDITS</div>
                <div class="status-value" id="credits">1,000</div>
            </div>
            <div class="status-item">
                <div class="status-label">FUEL</div>
                <div class="status-value" id="fuel">100%</div>
            </div>
            <div class="status-item">
                <div class="status-label">HULL</div>
                <div class="status-value" id="hull">100%</div>
            </div>
            <div class="status-item">
                <div class="status-label">CARGO</div>
                <div class="status-value" id="cargo">0/50 tons</div>
            </div>
        </div>

        <div class="main-display">
            <div class="scanner">
                <h3>SCANNER - NEARBY ASTEROIDS</h3>
                <div style="font-size: 14px; color: #ffff00; margin-bottom: 10px; text-align: center;">
                    <div>â›½ 20 fuel required to return to station</div>
                    <div>ðŸ“¡ Only asteroids in safe return range are shown</div>
                </div>
                <div id="asteroid-list">
                    <p>Click SCAN to detect nearby asteroids...</p>
                </div>
            </div>
            <div class="cargo">
                <h3>CARGO MANIFEST</h3>
                <div id="cargo-list">
                    <p>Cargo hold empty</p>
                </div>
            </div>
        </div>

        <div class="log" id="log">
            <div class="log-entry">Systems online. Ready for operations.</div>
        </div>

        <div class="controls">
            <button onclick="scanAsteroids()">SCAN AREA</button>
            <button id="mine-btn" onclick="mineAsteroid()" disabled>MINE ASTEROID</button>
            <button onclick="goToStation()">GO TO STATION</button>
            <button onclick="goBack()">RESTART</button>
        </div>
    </div>

    <script>
        let gameState = {
            pilotName: '',
            shipName: '',
            credits: 1000,
            fuel: 100,
            hull: 100,
            cargoUsed: 0,
            cargoMax: 50,
            selectedAsteroid: null
        };

        let asteroids = [];
        let cargo = {};

        const oreTypes = {
            'Ice': { value: 5, rarity: 0.8, grade: 'F' },
            'Iron': { value: 10, rarity: 0.7, grade: 'E' },
            'Copper': { value: 15, rarity: 0.6, grade: 'D' },
            'Nickel': { value: 25, rarity: 0.5, grade: 'D' },
            'Titanium': { value: 50, rarity: 0.4, grade: 'C' },
            'Palladium': { value: 80, rarity: 0.3, grade: 'B' },
            'Platinum': { value: 100, rarity: 0.2, grade: 'B' },
            'Nebulite': { value: 150, rarity: 0.15, grade: 'A' },
            'Quantum Crystal': { value: 200, rarity: 0.1, grade: 'S' },
            'Voidstone': { value: 300, rarity: 0.05, grade: 'SS' }
        };

        function log(message) {
            const logDiv = document.getElementById('log');
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logDiv.appendChild(entry);
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        function updateDisplay() {
            document.getElementById('credits').textContent = gameState.credits.toLocaleString();
            document.getElementById('fuel').textContent = gameState.fuel + '%';
            document.getElementById('hull').textContent = gameState.hull + '%';
            document.getElementById('cargo').textContent = `${gameState.cargoUsed}/${gameState.cargoMax} tons`;
            
            // Update cargo display
            const cargoList = document.getElementById('cargo-list');
            cargoList.innerHTML = '';
            
            let hasItems = false;
            for (let ore in cargo) {
                if (cargo[ore] > 0) {
                    hasItems = true;
                    const div = document.createElement('div');
                    div.className = 'cargo-item';
                    div.innerHTML = `<strong>${ore}</strong>: ${cargo[ore]} tons (${oreTypes[ore].value * cargo[ore]} credits)`;
                    cargoList.appendChild(div);
                }
            }
            
            if (!hasItems) {
                cargoList.innerHTML = '<p>Cargo hold empty</p>';
            }
        }

        function startGame() {
            const pilotName = document.getElementById('pilot-name').value.trim();
            const shipName = document.getElementById('ship-name').value.trim();
            
            if (!pilotName || !shipName) {
                alert('Please enter both pilot name and ship name.');
                return;
            }

            gameState.pilotName = pilotName;
            gameState.shipName = shipName;
            
            document.getElementById('display-pilot').textContent = pilotName;
            document.getElementById('display-ship').textContent = shipName;
            
            document.getElementById('setup-screen').classList.add('hidden');
            document.getElementById('game-screen').classList.remove('hidden');
            
            log(`Welcome aboard, Captain ${pilotName}. The ${shipName} is ready for operations.`);
        }
        
        function goBack() {
            document.getElementById('game-screen').classList.add('hidden');
            document.getElementById('setup-screen').classList.remove('hidden');
        }

        function generateAsteroids() {
            asteroids = [];
            for (let i = 0; i < 5; i++) {
                const asteroid = {
                    id: i,
                    distance: Math.random() * 10 + 1,
                    ores: {}
                };

                // Generate random ores
                for (let ore in oreTypes) {
                    if (Math.random() < oreTypes[ore].rarity) {
                        asteroid.ores[ore] = Math.floor(Math.random() * 15 + 5);
                    }
                }

                asteroids.push(asteroid);
            }
        }

        function scanAsteroids() {
            const scanFuelCost = 5;
            const stationFuelCost = 20;

            if (gameState.fuel < scanFuelCost) {
                alert('Scanner offline - insufficient fuel!');
                return;
            }

            // Warn if scanning would leave insufficient fuel to return
            if (gameState.fuel - scanFuelCost < stationFuelCost) {
                const remainingFuel = gameState.fuel - scanFuelCost;
                if (!confirm(`FUEL WARNING!\n\nScanning will consume ${scanFuelCost} fuel.\nAfter scanning, you'll have ${remainingFuel} fuel remaining.\nYou need ${stationFuelCost} fuel to return to station.\n\nProceed with scan?`)) {
                    return;
                }
            }

            gameState.fuel -= scanFuelCost;
            generateAsteroids();
            
            const asteroidList = document.getElementById('asteroid-list');
            asteroidList.innerHTML = '';

            asteroids.forEach(asteroid => {
                const div = document.createElement('div');
                div.className = 'asteroid-item';
                div.onclick = () => selectAsteroid(asteroid.id);
                
                let oreListWithGrades = Object.keys(asteroid.ores).map(ore => {
                    const grade = oreTypes[ore].grade;
                    const gradeColor = grade === 'SS' ? '#ff1493' : 
                                     grade === 'S' ? '#9966cc' : 
                                     grade === 'A' ? '#00ffff' : 
                                     grade === 'B' ? '#ffd700' : 
                                     grade === 'C' ? '#c0c0c0' : 
                                     grade === 'D' ? '#cd7f32' : 
                                     grade === 'E' ? '#8b4513' : '#666666';
                    return `<span style="color: ${gradeColor}; font-weight: bold;">[${grade}]</span> ${ore}: ${asteroid.ores[ore]}t`;
                }).join('<br>');
                
                if (!oreListWithGrades) oreListWithGrades = 'No valuable ores detected';
                
                div.innerHTML = `
                    <strong>Asteroid ${asteroid.id + 1}</strong><br>
                    Distance: ${asteroid.distance.toFixed(1)} km<br>
                    Ores:<br>${oreListWithGrades}
                `;
                asteroidList.appendChild(div);
            });

            log('Area scan complete. ' + asteroids.length + ' asteroids detected.');
            updateDisplay();
        }

        function selectAsteroid(id) {
            gameState.selectedAsteroid = id;
            
            // Remove previous selection
            document.querySelectorAll('.asteroid-item').forEach(item => {
                item.classList.remove('selected');
            });
            
            // Highlight selected
            event.target.classList.add('selected');
            
            document.getElementById('mine-btn').disabled = false;
            log(`Asteroid ${id + 1} selected for mining operations.`);
        }

        function mineAsteroid() {
            if (gameState.selectedAsteroid === null) {
                alert('No asteroid selected!');
                return;
            }

            const mineFuelCost = 10;
            const stationFuelCost = 20;

            if (gameState.fuel < mineFuelCost) {
                alert('Mining laser offline - insufficient fuel!');
                return;
            }

            // Warn if mining would leave insufficient fuel to return
            if (gameState.fuel - mineFuelCost < stationFuelCost) {
                const remainingFuel = gameState.fuel - mineFuelCost;
                if (!confirm(`FUEL WARNING!\n\nMining will consume ${mineFuelCost} fuel.\nAfter mining, you'll have ${remainingFuel} fuel remaining.\nYou need ${stationFuelCost} fuel to return to station.\n\nProceed with mining operation?`)) {
                    return;
                }
            }

            if (gameState.cargoUsed >= gameState.cargoMax) {
                alert('Cargo hold full! Return to station.');
                return;
            }

            const asteroid = asteroids[gameState.selectedAsteroid];
            const availableOres = Object.keys(asteroid.ores);
            
            if (availableOres.length === 0) {
                alert('Asteroid depleted!');
                return;
            }

            gameState.fuel -= mineFuelCost;
            
            // Extract random ore
            const oreToMine = availableOres[Math.floor(Math.random() * availableOres.length)];
            const amountMined = Math.min(
                Math.floor(Math.random() * 3 + 1),
                asteroid.ores[oreToMine],
                gameState.cargoMax - gameState.cargoUsed
            );

            asteroid.ores[oreToMine] -= amountMined;
            if (asteroid.ores[oreToMine] <= 0) {
                delete asteroid.ores[oreToMine];
            }

            if (!cargo[oreToMine]) cargo[oreToMine] = 0;
            cargo[oreToMine] += amountMined;
            gameState.cargoUsed += amountMined;

            log(`Mined ${amountMined} tons of ${oreToMine} from Asteroid ${gameState.selectedAsteroid + 1}`);
            
            // Refresh display
            scanAsteroids();
            updateDisplay();
        }

        function goToStation() {
            if (gameState.fuel < 20) {
                alert('Insufficient fuel for station travel!');
                return;
            }

            gameState.fuel -= 20;
            
            let totalValue = 0;
            for (let ore in cargo) {
                if (cargo[ore] > 0) {
                    const value = cargo[ore] * oreTypes[ore].value;
                    totalValue += value;
                    log(`Sold ${cargo[ore]} tons of ${ore} for ${value} credits`);
                    cargo[ore] = 0;
                }
            }

            gameState.credits += totalValue;
            gameState.cargoUsed = 0;
            gameState.fuel = Math.min(100, gameState.fuel + 30);

            if (totalValue > 0) {
                log(`Total earned: ${totalValue} credits. Fuel replenished.`);
            } else {
                log('No cargo to sell. Fuel replenished.');
            }

            updateDisplay();
        }

        // Initialize display
        updateDisplay();
    </script>
</body>
</html>
